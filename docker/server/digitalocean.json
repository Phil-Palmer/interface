{
	"builders": [
		{
			"type": "digitalocean",
			"ssh_username": "root",
			"image": "ubuntu-18-04-x64",
			"region": "nyc1",
			"size": "4gb",
			"snapshot_name": "tivolicloud/server:{{ user `version` }}"
		}
	],
	"provisioners": [
		{
			"type": "file",
			"source": "docker-compose.yml",
			"destination": "/root/docker-compose.yml"
		},
		{
			"type": "shell",
			"inline": [
				"apt-get update -y",
				"apt-get install -y apt-transport-https ca-certificates curl software-properties-common",

				"curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -",
				"apt-key fingerprint 0EBFCD88",
				"add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"",
				"apt-get update -y",

				"apt-get install -y docker-ce docker-ce-cli containerd.io docker-compose",

				"cd /root",
				"docker-compose up -d"
			]
		}
	]
}
