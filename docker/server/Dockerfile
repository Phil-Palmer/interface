FROM debian:10

ENV HIFI_DOMAIN_SERVER_HTTP_PORT=40100
ENV HIFI_DOMAIN_SERVER_HTTPS_PORT=40101
ENV HIFI_DOMAIN_SERVER_PORT=40102
ENV HIFI_DOMAIN_SERVER_DTLS_PORT=40103

ENV HIFI_ASSIGNMENT_CLIENT_AUDIO_MIXER_PORT=48000
ENV HIFI_ASSIGNMENT_CLIENT_AVATAR_MIXER_PORT=48001
ENV HIFI_ASSIGNMENT_CLIENT_ASSET_SERVER_PORT=48003
ENV HIFI_ASSIGNMENT_CLIENT_MESSAGES_MIXER_PORT=48004
ENV HIFI_ASSIGNMENT_CLIENT_ENTITY_SCRIPT_SERVER_PORT=48005
ENV HIFI_ASSIGNMENT_CLIENT_ENTITIES_SERVER_PORT=48006

# RUN pacman -Syu --noconfirm curl pm2
RUN \
apt-get update -y && \
apt-get install -y curl glib2.0 libgl1-mesa-glx libharfbuzz-bin && \
\
curl -sL https://deb.nodesource.com/setup_12.x | bash - && \
apt-get install -y nodejs && \
npm i -g pm2

COPY dist/. /root

CMD pm2-runtime start /root/ecosystem.config.js
