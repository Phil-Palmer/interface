<div class="messages">
	<div
		class="background animated"
		[style.opacity]="chatService.focused ? '1' : '0'"
	></div>
	<div #messages class="content">
		<div
			class="message transition"
			*ngFor="let message of chatService.messages; let i = index"
			[style.transitionDelay]="
				(chatService.messages.length - 1 - i) * 10 + 'ms'
			"
			[style.opacity]="
				chatService.focused || message.shouldBeShowing ? '1' : '0'
			"
			@message
		>
			<div
				class="avatar"
				*ngIf="message.username"
				[style.backgroundImage]="
					'url(' +
					scriptService.metaverseUrl +
					'/api/user/' +
					message.username.toLowerCase() +
					'/image), url(./assets/default-user-icon.jpg)'
				"
			></div>
			<div class="username">
				{{
					message.type == "message"
						? message.username + ":"
						: message.message
				}}
			</div>
			<ng-container *ngIf="message.type == 'message'">
				<ng-container *ngFor="let part of message.messageParts">
					<ng-container *ngIf="part.html == false">{{
						part.content
					}}</ng-container>
					<span
						*ngIf="part.html == true"
						[innerHTML]="part.content"
					></span>
				</ng-container>
			</ng-container>
			<img
				*ngIf="message.imageUrl"
				[src]="message.imageUrl"
				class="image"
			/>
		</div>
	</div>
</div>
